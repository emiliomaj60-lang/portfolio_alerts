<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Scheda Riassuntiva</title>
    <link rel="stylesheet" href="/static/style.css">

    <style>
        table {
            font-size: 26px;
        }
        th {
            width: 45%;
            font-size: 28px;
        }
        td {
            font-size: 28px;
        }
        h1 {
            font-size: 42px;
        }
        h2 {
            font-size: 40px;
        }
        h3 {
            font-size: 30px;
        }
        .positivo {
            color: #2e7d32;
            font-weight: bold;
        }
        .negativo {
            color: #c62828;
            font-weight: bold;
        }
        .highlight {
            font-size: 32px;
            font-weight: bold;
            color: #1e88e5;
        }
        .section-title {
            font-size: 30px;
            font-weight: bold;
            color: #0d47a1;
            padding-top: 20px;
            padding-bottom: 10px;
        }
        .back-btn {
            display: inline-block;
            padding: 18px 32px;
            background: #1e88e5;
            color: white;
            font-size: 28px;
            font-weight: bold;
            border-radius: 12px;
            text-decoration: none;
            transition: background 0.2s ease;
        }
        .back-btn:hover {
            background: #1565c0;
        }
        .back-btn:active {
            background: #0d47a1;
        }
    </style>
</head>
<body>

<header>
    <h1>SCHEDA RIASSUNTIVA</h1>
</header>

<div class="container">

    <!-- ðŸ”µ NOME + ISIN -->
    <h2 style="text-align:center; margin-bottom:5px;">
        {{ titolo.nome }}
    </h2>

    <h3 style="text-align:center; margin-top:0; margin-bottom:25px; color:#0d47a1;">
        ISIN: {{ titolo.isin }}
    </h3>

    <table>

        <!-- ðŸ”µ SEZIONE ACQUISTO -->
        <tr>
            <td colspan="2" class="section-title">
                DATI DI ACQUISTO <span style="font-size:22px; color:#555;">({{ titolo.data_acquisto }})</span>
            </td>
        </tr>

        <tr>
            <th>Prezzo di Acquisto (unitario)</th>
            <td class="highlight">{{ prezzo_acquisto_unitario }} â‚¬</td>
        </tr>

        <tr>
            <th>NÂ° Azioni</th>
            <td>{{ titolo.quantita|int }}</td>
        </tr>

        <tr>
            <th>Valore Totale Acquisto</th>
            <td>{{ valore_acquisto|round(0)|int }} â‚¬</td>
        </tr>

        <tr>
            <th>Spese Fisse Acquisto</th>
            <td>{{ spese_fisse_acq }} â‚¬</td>
        </tr>

        <tr>
            <th>Commissioni Acquisto</th>
            <td>{{ commissioni_acq | round(0) }} â‚¬</td>
        </tr>

        <tr>
            <th><b>TOTALE SPESO</b></th>
            <td class="highlight"><b>{{ totale_speso | round(0) }} â‚¬</b></td>
        </tr>

        <tr><td colspan="2" style="height:35px;"></td></tr>

        <!-- ðŸ”µ SEZIONE VENDITA -->
        <tr>
            <td colspan="2" class="section-title">DATI DI VENDITA (OGGI)</td>
        </tr>

        <tr>
            <th>Prezzo Attuale (unitario)</th>
            <td class="highlight">{{ prezzo_vendita_unitario }} â‚¬</td>
        </tr>

        <!-- ðŸ”µ SIMULAZIONE -->
        <tr>
            <th>Simula prezzo vendita</th>
            <td>
                <input id="simulazionePrezzo" type="number" step="0.01"
                       style="font-size:24px; padding:6px; width:160px;">
                <button onclick="simulaVendita()"
                        style="font-size:22px; padding:6px 14px; margin-left:10px;
                               background:#1e88e5; color:white; border:none;
                               border-radius:8px; cursor:pointer;">
                    Simula
                </button>
            </td>
        </tr>

        <tr>
            <th>Valore Totale Vendita</th>
            <td id="valoreVenditaCell">{{ valore_vendita|round(0)|int }} â‚¬</td>
        </tr>

        <tr>
            <th>Spese Fisse Vendita</th>
            <td>{{ spese_fisse_vend }} â‚¬</td>
        </tr>

        <tr>
            <th>Commissioni Vendita</th>
            <td>{{ commissioni_vend | round(1) }} â‚¬</td>
        </tr>

        <tr>
            <th><b>TOTALE INCASSATO</b></th>
            <td id="totaleIncassatoCell" class="highlight">
                <b>{{ totale_incassato | round(0) }} â‚¬</b>
            </td>
        </tr>

        <tr><td colspan="2" style="height:35px;"></td></tr>

        <!-- ðŸ”µ GUADAGNO NETTO -->
        <tr>
            <th><b>GUADAGNO NETTO SE VENDI ORA</b></th>
            <td id="guadagnoNettoCell"
                class="{% if guadagno_netto >= 0 %}positivo{% else %}negativo{% endif %}">
                <b style="font-size:36px;">{{ guadagno_netto | round(0) }} â‚¬</b>
            </td>
        </tr>

    </table>

    <div style="text-align:center; margin-top:40px;">
        <a href="/" class="back-btn">â¬… Torna al Portafoglio</a>
    </div>

</div>

<!-- ðŸ”µ SCRIPT SIMULAZIONE -->
<script>
function simulaVendita() {
    const prezzo = parseFloat(document.getElementById("simulazionePrezzo").value);
    if (!prezzo || prezzo <= 0) return;

    const quantita = {{ titolo.quantita }};
    const speseFisseVend = {{ spese_fisse_vend }};
    const commissioniPerc = {{ costi["commissioni_vendita"] }} / 100;

    const valoreVendita = prezzo * quantita;
    const commissioni = valoreVendita * commissioniPerc;
    const totaleIncassato = valoreVendita - speseFisseVend - commissioni;

    const totaleSpeso = {{ totale_speso }};
    const guadagnoNetto = totaleIncassato - totaleSpeso;

    document.getElementById("valoreVenditaCell").innerText = valoreVendita.toFixed(2) + " â‚¬";
    document.getElementById("totaleIncassatoCell").innerText = totaleIncassato.toFixed(2) + " â‚¬";

    const guadagnoCell = document.getElementById("guadagnoNettoCell");
    guadagnoCell.innerText = guadagnoNetto.toFixed(2) + " â‚¬";
    guadagnoCell.className = guadagnoNetto >= 0 ? "positivo" : "negativo";
}
</script>

</body>
</html>